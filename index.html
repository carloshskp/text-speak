<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Leitor de Texto Online - Text-to-Speech em Português | TTS Grátis</title>

  <!-- Meta Tags Básicas -->
  <meta name="description"
    content="Leitor de texto online gratuito. Converta qualquer texto em voz usando síntese de fala do navegador. Suporta português brasileiro (pt-BR) com controle de velocidade." />
  <meta name="keywords"
    content="leitor de texto, text to speech, TTS, síntese de fala, leitor de voz, conversor texto voz, português brasileiro, pt-BR, leitor online, grátis" />
  <meta name="author" content="Leitor de Texto" />
  <meta name="robots" content="index, follow" />
  <meta name="language" content="pt-BR" />

  <!-- Canonical URL -->
  <link rel="canonical" href="https://text-reader.carloshb.com.br" />

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="assets/logo.svg" />

  <!-- Open Graph Tags -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Leitor de Texto Online - Text-to-Speech em Português | TTS Grátis" />
  <meta property="og:description"
    content="Leitor de texto online gratuito. Converta qualquer texto em voz usando síntese de fala do navegador. Suporta português brasileiro (pt-BR) com controle de velocidade." />
  <meta property="og:url" content="https://text-reader.carloshb.com.br" />
  <meta property="og:image" content="https://text-reader.carloshb.com.br/img.png" />
  <meta property="og:locale" content="pt_BR" />
  <meta property="og:site_name" content="Leitor de Texto" />

  <!-- Twitter Card Tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Leitor de Texto Online - Text-to-Speech em Português | TTS Grátis" />
  <meta name="twitter:description"
    content="Leitor de texto online gratuito. Converta qualquer texto em voz usando síntese de fala do navegador. Suporta português brasileiro (pt-BR) com controle de velocidade." />
  <meta name="twitter:image" content="https://text-reader.carloshb.com.br/img.png" />

  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Leitor de Texto",
      "description": "Leitor de texto online gratuito que converte qualquer texto em voz usando síntese de fala do navegador. Suporta português brasileiro (pt-BR) com controle de velocidade de reprodução.",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "BRL"
      },
      "featureList": [
        "Síntese de fala em português brasileiro (pt-BR)",
        "Controle de velocidade de reprodução (0.5x a 2.0x)",
        "Pausa e retomada de reprodução",
        "Salvamento de texto no navegador",
        "Interface responsiva e moderna"
      ],
      "browserRequirements": "Requires JavaScript. Requires HTML5.",
      "inLanguage": "pt-BR",
      "url": "https://text-reader.carloshb.com.br"
    }
    </script>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'gradient-start': '#2ecc71',
            'gradient-end': '#3498db',
            'text-primary': '#2c3e50',
          }
        }
      }
    }
  </script>
  <!-- Google Analytics & GTM (adiado para thread ociosa ou interação) -->
  <script defer src="./analytics.js"></script>
  <style>
    :root {
      --color-primary: #2c3e50;
      --color-border: rgba(255, 255, 255, 0.3);
      --gradient-bg: linear-gradient(135deg, #2ecc71 0%, #3498db 100%);
    }

    body {
      background: var(--gradient-bg);
    }

    .btn-shine {
      position: relative;
      overflow: hidden;
    }

    .btn-shine::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, var(--color-border), transparent);
      transform: skewX(-25deg);
      transition: left 0.5s ease;
    }

    .btn-shine:hover::before {
      left: 100%;
    }

    .btn-shine>* {
      position: relative;
      z-index: 1;
    }

    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      background: var(--color-primary);
      cursor: pointer;
      width: 100%;
      height: 8px;
    }

    input[type="range"]::-webkit-slider-track,
    input[type="range"]::-moz-range-track {
      background: var(--color-primary);
      height: 8px;
      border-radius: 4px;
      border: 1px solid var(--color-border);
    }

    input[type="range"]::-webkit-slider-thumb,
    input[type="range"]::-moz-range-thumb {
      -webkit-appearance: none;
      appearance: none;
      background: var(--color-primary);
      height: 20px;
      width: 20px;
      border-radius: 50%;
      border: 2px solid var(--color-border);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    input[type="range"]::-webkit-slider-thumb:hover,
    input[type="range"]::-moz-range-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    textarea::placeholder {
      color: var(--color-primary);
      opacity: 0.6;
    }

    button:disabled,
    input:disabled,
    textarea:disabled {
      cursor: not-allowed !important;
    }
  </style>
</head>

<body class="min-h-screen antialiased flex items-center justify-center p-6 pb-24">
  <main
    class="w-full max-w-2xl space-y-6 bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 shadow-2xl p-8">
    <header class="flex flex-col sm:flex-row sm:items-center gap-4 text-primary">
      <img src="assets/logo.svg" alt="Logo Leitor de Texto" class="h-16 w-16 drop-shadow-lg" loading="lazy" />
      <div class="space-y-1">
        <h1 class="text-3xl font-bold tracking-tight drop-shadow-lg text-primary">Leitor de texto</h1>
        <p class="text-sm text-primary opacity-80">Converta textos em voz diretamente no seu navegador.</p>
      </div>
    </header>

    <div class="space-y-2">
      <label for="text" class="block text-sm font-semibold text-primary">Texto</label>
      <textarea id="text"
        class="w-full min-h-48 rounded-lg bg-white/20 backdrop-blur-md border border-white/30 p-4 outline-none ring-2 ring-transparent focus:ring-white/50 focus:border-white/50 resize-vertical transition-all duration-200 shadow-lg text-primary"
        placeholder="Digite algo para o navegador ler em voz alta…">Coloque seu texto aqui, ou aperte play para ouvir essa instrução.</textarea>
    </div>

    <div
      class="w-full px-4 py-3 rounded-lg bg-white/30 backdrop-blur-sm border-2 border-white/50 shadow-xl flex items-center gap-3">
      <button id="btnPlay"
        class="btn-shine inline-flex items-center justify-center px-4 py-3 rounded-lg bg-white/30 backdrop-blur-sm font-semibold border-2 border-white/50 shadow-xl hover:bg-white/40 hover:shadow-2xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-primary">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z" /></svg>
      </button>
      <button id="btnPause"
        class="btn-shine inline-flex items-center justify-center px-4 py-3 rounded-lg bg-white/30 backdrop-blur-sm font-semibold border-2 border-white/50 shadow-xl hover:bg-white/40 hover:shadow-2xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-primary"
        disabled>
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect x="14" y="3" width="5" height="18" rx="1" /><rect x="5" y="3" width="5" height="18" rx="1" /></svg>
      </button>
      <button id="btnSave"
        class="btn-shine inline-flex items-center justify-center px-4 py-3 rounded-lg bg-white/20 backdrop-blur-sm font-semibold border border-white/30 shadow-lg hover:bg-white/30 hover:shadow-xl transition-all duration-200 text-primary disabled:opacity-50 disabled:cursor-not-allowed"
        disabled>
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" /><path d="M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7" /><path d="M7 3v4a1 1 0 0 0 1 1h7" /></svg>
      </button>
      <button id="btnClear"
        class="btn-shine inline-flex items-center justify-center px-4 py-3 rounded-lg bg-white/20 backdrop-blur-sm font-semibold border border-white/30 shadow-lg hover:bg-white/30 hover:shadow-xl transition-all duration-200 text-primary disabled:opacity-50 disabled:cursor-not-allowed"
        title="Limpar texto">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M10 11v6" /><path d="M14 11v6" /><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6" /><path d="M3 6h18" /><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" /></svg>
      </button>
      <div class="flex items-center gap-3 flex-1 min-w-0">
        <span class="font-semibold text-sm whitespace-nowrap text-primary">0.5x</span>
        <input type="range" id="rate" min="0.5" max="2.0" step="0.1" value="1.0" class="flex-1 min-w-0" />
        <span class="font-semibold text-sm whitespace-nowrap text-primary">2x</span>
        <span id="rateValue"
          class="font-bold text-sm whitespace-nowrap px-3 py-1 rounded-lg bg-white/50 backdrop-blur-md border border-white/40 text-primary">1.0x</span>
      </div>
    </div>

    <p class="text-sm leading-relaxed text-primary">
      Use o botão <span class="font-semibold">Reproduzir</span> para ouvir o texto.
      <br class="sm:hidden" />
      O botão <span class="font-semibold">Salvar</span> guarda o conteúdo de texto no navegador.
    </p>

    <footer class="text-xs text-primary">
      Dica: tentamos selecionar automaticamente uma voz <span class="whitespace-nowrap">pt-BR</span> se existir no
      sistema. <a href="https://text-reader.carloshb.com.br/README.pt-BR.md"
        class="underline font-semibold hover:opacity-80 transition-opacity">Acesse a documentação para mais detalhes.</a>
    </footer>
  </main>

  <div id="toast" class="fixed inset-x-0 top-4 flex justify-center pointer-events-none z-50"></div>

  <!-- Modal de Doação -->
  <div id="donationModal"
    class="hidden inset-0 z-50 flex items-center justify-center p-4 pointer-events-none opacity-0 transition-opacity duration-300">
    <div class="fixed inset-0 bg-black/40 backdrop-blur-sm" onclick="closeDonationModal()"></div>
    <div
      class="relative bg-white/75 backdrop-blur-md rounded-2xl border border-white/20 shadow-2xl p-8 max-w-md w-full pointer-events-auto transform scale-95 transition-transform duration-300">
      <button onclick="closeDonationModal()"
        class="absolute top-4 right-4 text-primary hover:opacity-70 transition-opacity">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M18 6 6 18" /><path d="m6 6 12 12" /></svg>
      </button>
      <div class="text-center space-y-4">
        <div class="flex justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-primary" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5" /></svg>
        </div>
        <div class="flex justify-center">
          <div id="qrCodePlaceholder"
            class="w-48 h-48 bg-white/20 backdrop-blur-sm border-2 border-white/30 rounded-lg flex items-center justify-center p-3 overflow-hidden">
            <span class="sr-only">QR Code do PIX</span>
            <div aria-hidden="true" class="w-full h-full rounded-md border border-dashed border-white/40 flex items-center justify-center text-xs font-semibold text-primary/70">
              QR Code
            </div>
          </div>
        </div>
        <h2 class="text-2xl font-bold text-primary">Gostou do Leitor de Texto?</h2>
        <p class="text-sm text-primary opacity-90">
          Se este projeto foi útil para você, considere fazer uma doação para apoiar o desenvolvimento contínuo.
        </p>
        <div class="flex justify-center pt-2">
          <button onclick="closeDonationModal()"
            class="btn-shine inline-flex items-center justify-center gap-2 px-6 py-3 rounded-lg bg-white/20 backdrop-blur-sm font-semibold border border-white/30 shadow-lg hover:bg-white/30 hover:shadow-xl transition-all duration-200 text-primary">
            Talvez Depois
          </button>
        </div>
      </div>
    </div>
  </div>

  <footer class="fixed bottom-0 left-0 right-0 z-40 flex justify-center p-4">
    <div class="bg-white/10 backdrop-blur-md border border-white/20 rounded-xl shadow-2xl px-6 py-4 max-w-2xl w-full">
      <div class="flex flex-col sm:flex-row items-center justify-between gap-3 text-center sm:text-left">
        <div class="text-xs text-primary">
          <p class="inline-flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 inline-block" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="10" /><path d="M14.83 14.83a4 4 0 1 1 0-5.66" /></svg>
            2025 Carlos Bernardes. Todos os direitos reservados.
          </p>
        </div>
        <div class="text-xs text-primary">
          <p class="inline-flex items-center gap-1">
            Gostou? <a target="_blank" href="https://github.com/carloshskp/text-reader" class="font-semibold hover:opacity-80 underline transition-colors duration-200 text-primary cursor-pointer">contribua</a> ou
            <a id="donationLink" href="#"
              class="font-semibold hover:opacity-80 underline transition-colors duration-200 text-primary cursor-pointer">apoie
              o projeto</a>
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 inline-block" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5" /></svg>
          </p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N5CK6BH8" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <script>
    const STORAGE_KEY = 'demo_tts_text';
    const RATE_KEY = 'demo_tts_rate';

    const synth = window.speechSynthesis;
    const textEl = document.getElementById('text');
    const playBtn = document.getElementById('btnPlay');
    const pauseBtn = document.getElementById('btnPause');
    const saveBtn = document.getElementById('btnSave');
    const clearBtn = document.getElementById('btnClear');
    const rateSlider = document.getElementById('rate');
    const rateValue = document.getElementById('rateValue');
    const donationModal = document.getElementById('donationModal');

    let isPlaying = false;
    let currentUtterance = null;
    let cachedVoices = [];

    function initStorage() {
      try {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) textEl.value = saved;
        const savedRate = localStorage.getItem(RATE_KEY);
        if (savedRate) {
          rateSlider.value = savedRate;
          rateValue.textContent = parseFloat(savedRate).toFixed(1) + 'x';
        }
      } catch (_) { }
    }

    function cacheVoices() {
      const voices = synth.getVoices();
      if (voices && voices.length) cachedVoices = voices;
    }

    function pickPtVoice() {
      if (!cachedVoices.length) return null;
      return (
        cachedVoices.find(v => /pt-BR/i.test(v.lang)) ||
        cachedVoices.find(v => /^pt/i.test(v.lang)) ||
        null
      );
    }

    function createUtterance(text, rate) {
      const utter = new SpeechSynthesisUtterance(text);
      const voice = pickPtVoice();

      if (voice) {
        utter.voice = voice;
        utter.lang = voice.lang;
      } else {
        utter.lang = 'pt-BR';
      }

      utter.rate = parseFloat(rate);
      utter.pitch = 1.0;
      utter.volume = 1.0;

      return utter;
    }

    initStorage();
    cacheVoices();
    synth.onvoiceschanged = cacheVoices;

    function toast(msg) {
      const host = document.getElementById('toast');
      const el = document.createElement('div');
      el.className =
        "pointer-events-auto bg-white/95 backdrop-blur-md text-slate-900 border border-white/30 rounded-lg px-5 py-3 shadow-2xl font-medium animate-in fade-in slide-in-from-top-2 duration-300";
      el.textContent = msg;
      host.appendChild(el);
      setTimeout(() => {
        el.classList.add('opacity-0', 'transition-all', 'duration-300');
        setTimeout(() => host.removeChild(el), 300);
      }, 2000);
    }

    function updateButtonsState(playing) {
      isPlaying = playing;
      playBtn.disabled = playing;
      pauseBtn.disabled = !playing;
      if (typeof clearBtn !== 'undefined' && clearBtn !== null) {
        // Clear button is enabled only when there is no active playback
        clearBtn.disabled = playing;
      }
    }

    function showDonationModal() {
      if (!donationModal.dataset.qrLoaded) {
        const placeholder = document.getElementById('qrCodePlaceholder');
        if (placeholder) {
          const qrImg = document.createElement('img');
          qrImg.src = 'assets/qr-code.svg';
          qrImg.alt = 'QR Code para doações via PIX';
          qrImg.loading = 'lazy';
          qrImg.decoding = 'async';
          qrImg.width = 192;
          qrImg.height = 192;
          qrImg.className = 'max-w-full max-h-full';
          placeholder.replaceChildren(qrImg);
          donationModal.dataset.qrLoaded = 'true';
        }
      }
      donationModal.classList.remove('opacity-0', 'pointer-events-none', 'hidden');
      donationModal.classList.add('opacity-100', 'fixed');
      const overlay = donationModal.firstElementChild;
      if (overlay) overlay.style.pointerEvents = 'auto';
      const modalContent = donationModal.querySelector('.relative');
      if (modalContent) {
        modalContent.style.pointerEvents = 'auto';
        modalContent.classList.remove('scale-95');
        modalContent.classList.add('scale-100');
      }
    }

    function closeDonationModal() {
      donationModal.classList.remove('opacity-100', 'fixed');
      donationModal.classList.add('pointer-events-none', 'opacity-0', 'hidden');
      const overlay = donationModal.firstElementChild;
      if (overlay) overlay.style.pointerEvents = 'none';
      const modalContent = donationModal.querySelector('.relative');
      if (modalContent) {
        modalContent.style.pointerEvents = 'none';
        modalContent.classList.add('scale-95');
        modalContent.classList.remove('scale-100');
      }
    }

    window.closeDonationModal = closeDonationModal;
    window.showDonationModal = showDonationModal;

    function speakText(text) {
      currentUtterance = createUtterance(text, rateSlider.value);
      synth.speak(currentUtterance);

      setTimeout(() => {
        if (synth.speaking) {
          updateButtonsState(true);
        }
      }, 100);

      currentUtterance.onend = () => {
        updateButtonsState(false);
        currentUtterance = null;
        setTimeout(() => showDonationModal(), 500);
      };

      currentUtterance.onerror = () => {
        updateButtonsState(false);
        currentUtterance = null;
        toast('Não foi possível sintetizar a fala.');
      };
    }

    playBtn.addEventListener('click', () => {
      const text = textEl.value.trim();
      if (!text) return toast('Digite um texto para reproduzir.');
      if (synth.speaking || synth.pending) {
        synth.cancel();
      }
      speakText(text);
    });

    // Limpar texto: limpa o textarea e foca nele. Só habilitado quando não há reprodução ativa.
    if (clearBtn) {
      clearBtn.addEventListener('click', () => {
        try {
          textEl.value = '';
          // Atualiza armazenamento local para manter consistência
          try { localStorage.setItem(STORAGE_KEY, ''); } catch (_) { }
          textEl.focus();
          toast('Texto limpo.');
        } catch (err) {
          console.error('Erro ao limpar o texto', err);
        }
      });
    }

    pauseBtn.addEventListener('click', () => {
      if (synth.speaking) {
        synth.pause();
        updateButtonsState(false);
      } else if (synth.paused) {
        synth.resume();
        updateButtonsState(true);
      }
    });

    rateSlider.addEventListener('input', (e) => {
      const value = parseFloat(e.target.value);
      rateValue.textContent = value.toFixed(1) + 'x';
      try {
        localStorage.setItem(RATE_KEY, value.toString());
      } catch (_) { }

      if (currentUtterance && (synth.speaking || synth.paused)) {
        if (synth.paused) {
          currentUtterance.rate = value;
        } else {
          const text = textEl.value.trim();
          if (text) {
            synth.cancel();
            currentUtterance = createUtterance(text, value);
            synth.speak(currentUtterance);
            updateButtonsState(true);
          }
        }
      }
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !donationModal.classList.contains('opacity-0')) {
        closeDonationModal();
      }
    });

    const donationLink = document.getElementById('donationLink');
    if (donationLink) {
      donationLink.addEventListener('click', (e) => {
        e.preventDefault();
        showDonationModal();
      });
    }

  </script>
</body>

</html>
